import os

from dotenv import load_dotenv
from langgraph_supervisor import create_supervisor
from langchain.chat_models import init_chat_model

from langgraph_src.agent_supervisor.createWorkerAgent.mathAgent import math_agent
from langgraph_src.agent_supervisor.createWorkerAgent.agentSupervisorD import research_agent,pretty_print_messages

load_dotenv()
os.environ["DEEPSEEK_API_KEY"] = os.getenv("DEEPSEEK_API_KEY")


supervisor = create_supervisor(
    model=init_chat_model("deepseek-chat"),
    agents=[research_agent, math_agent],
    prompt=(
        "You are a supervisor managing two agents:\n"
        "- a research agent. Assign research-related tasks to this agent\n"
        "- a math agent. Assign math-related tasks to this agent\n"
        "Assign work to one agent at a time, do not call agents in parallel.\n"
        "Do not do any work yourself."
    ),
    add_handoff_back_messages=True,
    output_mode="full_history",
).compile()


#

if __name__ == "__main__":
    from IPython.display import Image, display

    try:
        # display(Image(graph.get_graph().draw_mermaid_png()))
        # 获取 PNG 数据
        png_data = supervisor.get_graph().draw_mermaid_png()
        filename = "agent-to-graph.png"
        # 保存到本地
        with open(filename, "wb") as f:
            f.write(png_data)

        # 显示图像（确保路径正确）
        display(Image(filename=filename))

    except Exception:
        # This requires some extra dependencies and is optional
        pass

    # re = supervisor.invoke(
    #     {"messages": [{"content": "What is the headcount for each of the FAANG companies in 2024?"}]})

    for chunk in supervisor.stream(
            {
                "messages": [
                    {
                        "role": "user",
                        "content": "find US and New York state GDP in 2024. what % of US GDP was New York state?",
                    }
                ]
            },
    ):
        pretty_print_messages(chunk, last_message=True)

    final_message_history = chunk["supervisor"]["messages"]
    print(final_message_history)


# <IPython.core.display.Image object>
# Update from node supervisor:
#
#
# ================================= Tool Message =================================
# Name: transfer_to_research_agent
#
# Successfully transferred to research_agent
#
#
# Update from node research_agent:
#
#
# ================================= Tool Message =================================
# Name: transfer_back_to_supervisor
#
# Successfully transferred back to supervisor
#
#
# Update from node supervisor:
#
#
# ================================= Tool Message =================================
# Name: transfer_to_math_agent
#
# Successfully transferred to math_agent
#
#
# Update from node math_agent:
#
#
# ================================= Tool Message =================================
# Name: transfer_back_to_supervisor
#
# Successfully transferred back to supervisor
#
#
# Update from node supervisor:
#
#
# ================================= Tool Message =================================
# Name: transfer_to_research_agent
#
# Successfully transferred to research_agent
#
#
# Update from node research_agent:
#
#
# ================================= Tool Message =================================
# Name: transfer_back_to_supervisor
#
# Successfully transferred back to supervisor
#
#
# Update from node supervisor:
#
#
# ================================== Ai Message ==================================
# Name: supervisor
#
# It appears that the exact nominal GDP figures for the US and New York in 2024 are not readily available in the sources provided. Would you like me to refine the search or explore alternative sources to find these specific values? Alternatively, we could proceed with estimates based on historical data if that would be helpful. Let me know how you'd like to proceed!
#
#
# [HumanMessage(content='find US and New York state GDP in 2024. what % of US GDP was New York state?', additional_kwargs={}, response_metadata={}, id='389c2fc5-303c-4174-8ebe-92791cfc4f22'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_0_c86eb55f-8c5f-4c2d-bae3-9722051d087c', 'function': {'arguments': '{}', 'name': 'transfer_to_research_agent'}, 'type': 'function', 'index': 0}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 18, 'prompt_tokens': 219, 'total_tokens': 237, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 192}, 'prompt_cache_hit_tokens': 192, 'prompt_cache_miss_tokens': 27}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': '461072ef-8bb9-4ddd-94dd-f95288cb9de2', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, name='supervisor', id='run--f3056cd4-d936-4e44-850c-6fec0de7270f-0', tool_calls=[{'name': 'transfer_to_research_agent', 'args': {}, 'id': 'call_0_c86eb55f-8c5f-4c2d-bae3-9722051d087c', 'type': 'tool_call'}], usage_metadata={'input_tokens': 219, 'output_tokens': 18, 'total_tokens': 237, 'input_token_details': {'cache_read': 192}, 'output_token_details': {}}), ToolMessage(content='Successfully transferred to research_agent', name='transfer_to_research_agent', id='4086face-7bbc-460a-9288-7c68d877d653', tool_call_id='call_0_c86eb55f-8c5f-4c2d-bae3-9722051d087c'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_0_be82072e-8c3a-45c4-bba5-c91ad4b01551', 'function': {'arguments': '{"query": "US GDP 2024"}', 'name': 'tavily_search'}, 'type': 'function', 'index': 0}, {'id': 'call_1_95e6b08c-b10b-48d2-9f55-f133b1960622', 'function': {'arguments': '{"query": "New York state GDP 2024"}', 'name': 'tavily_search'}, 'type': 'function', 'index': 1}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 51, 'prompt_tokens': 2044, 'total_tokens': 2095, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 1984}, 'prompt_cache_hit_tokens': 1984, 'prompt_cache_miss_tokens': 60}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': '20a6889c-4202-440a-8daa-29b183ffdd38', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, name='research_agent', id='run--79f7ab90-f5db-41f0-94a6-8e2bd3b95802-0', tool_calls=[{'name': 'tavily_search', 'args': {'query': 'US GDP 2024'}, 'id': 'call_0_be82072e-8c3a-45c4-bba5-c91ad4b01551', 'type': 'tool_call'}, {'name': 'tavily_search', 'args': {'query': 'New York state GDP 2024'}, 'id': 'call_1_95e6b08c-b10b-48d2-9f55-f133b1960622', 'type': 'tool_call'}], usage_metadata={'input_tokens': 2044, 'output_tokens': 51, 'total_tokens': 2095, 'input_token_details': {'cache_read': 1984}, 'output_token_details': {}}), ToolMessage(content='{"query": "US GDP 2024", "follow_up_questions": null, "answer": null, "images": [], "results": [{"url": "https://www.bea.gov/news/2025/gross-domestic-product-4th-quarter-and-year-2024-third-estimate-gdp-industry-and", "title": "Gross Domestic Product, 4th Quarter and Year 2024 (Third Estimate ...", "content": "Gross Domestic Product, 4th Quarter and Year 2024 (Third Estimate), GDP by Industry, and Corporate Profits | U.S. Bureau of Economic Analysis (BEA) **Real gross domestic product (GDP)** increased at an annual rate of 2.4 percent in the fourth quarter of 2024 (October, November, and December), according to the third estimate released by the U.S. Bureau of Economic Analysis. The **price index for gross domestic purchases** increased 2.2 percent in the fourth quarter, revised down 0.1 percentage point from the previous estimate. Real GDP increased at an annual rate of 2.4 percent (0.6 percent at a quarterly rate 1), an upward revision of 0.1 percentage point from the previous estimate, primarily reflecting a downward revision to imports that was partly offset by a downward revision to consumer spending.", "score": 0.98542, "raw_content": null}, {"url": "https://tradingeconomics.com/united-states/gdp", "title": "United States GDP - Trading Economics", "content": "The Gross Domestic Product (GDP) in the United States was worth 27720.71 billion US dollars in 2023, according to official data from the World Bank. This page provides - United States GDP - actual values, historical data, forecast, chart, statistics, economic calendar and news. | GDP Growth Rate | -0.20 | 2.40 | percent | Mar 2025 | GDP GDP GDP Annual Growth Rate GDP Growth Rate Core Inflation Rate MoM Core PCE Price Index MoM Core PCE Price Index YoY Export Prices MoM GDP Price Index Inflation Rate MoM PCE Price Index MoM House Price Index MoM House Price Index YoY Economic Calendar Historical Data News Stream Earnings Releases Credit Ratings Forecasts Markets Currencies Stocks Commodities Bonds Crypto Get Started", "score": 0.98239, "raw_content": null}, {"url": "https://en.wikipedia.org/wiki/Economy_of_the_United_States", "title": "Economy of the United States - Wikipedia", "content": "Economy of the United States - Wikipedia | Image 489Companies of the United States | | Government institutions | * Department of the Treasury * Department of Commerce * Department of Labor * Office of the United States Trade Representative * Small Business Administration * Internal Revenue Service * National Labor Relations Board * United States Trade and Development Agency * Customs and Border Protection * Office of the Comptroller of the Currency * Consumer Financial Protection Bureau * Securities and Exchange Commission * Federal Deposit Insurance Corporation * National Credit Union Administration * United States International Trade Commission * Statistics | | International development | * U.S. International Development Finance Corporation * Blue Dot Network * Partnership for Global Infrastructure and Investment * Export–Import Bank of the United States |", "score": 0.97895, "raw_content": null}], "response_time": 1.59}', name='tavily_search', id='c16cd530-9886-4436-9f36-e272457c78e7', tool_call_id='call_0_be82072e-8c3a-45c4-bba5-c91ad4b01551'), ToolMessage(content='{"query": "New York state GDP 2024", "follow_up_questions": null, "answer": null, "images": [], "results": [{"url": "https://www.statista.com/statistics/188087/gdp-of-the-us-federal-state-of-new-york-since-1997/", "title": "Real GDP New York U.S. 2024 - Statista", "content": "Consumer trends 2024 Statista Dossier Coffee market worldwide Statista Dossier Water industry worldwide Statista Dossier Digitalization of the travel industry Statista Dossier ## Real gross domestic product of New York in the United States from 2000 to 2023 (in billion U.S. dollars) Gross domestic product (GDP) refers to the market value of all final goods and services produced within a country in a given period. The 20 countries with the largest gross domestic product (GDP) per capita in 2025 (in U.S. dollars) Countries with the largest gross domestic product (GDP) per capita 2025 The 20 countries with the largest gross domestic product (GDP) in 2025 (in billion U.S. dollars) Countries with the largest gross domestic product (GDP) 2025", "score": 0.98529, "raw_content": null}, {"url": "https://en.wikipedia.org/wiki/Economy_of_New_York_(state)", "title": "Economy of New York (state) - Wikipedia", "content": "Economy of New York (state) - Wikipedia Economy of New York (state) If New York State were an independent nation, it would rank as the 8th largest economy in the world by nominal GDP. Wind is the predominant generating technology.[26] In 2018, the New York State Energy Research and Development Authority awarded long-term contracts to 22 utility-scale solar farms, totaling a combined capacity of 646 MW.[27]In 2012, LIPA adopted a power purchase agreement (limited to 50 MW), which will pay $0.22/kWh for solar generation for installations ranging from 50\xa0kW to 20 MW. State of New York Retrieved from \\"https://en.wikipedia.org/w/index.php?title=Economy_of_New_York_(state)&oldid=1284867348\\" Economy of New York (state) Economy of New York (state)", "score": 0.98428, "raw_content": null}, {"url": "https://usafacts.org/answers/what-is-the-gross-domestic-product-gdp/state/new-york/", "title": "What is the gross domestic product (GDP) in New York? - USAFacts", "content": "In 2024, New York’s real (that is, inflation-adjusted) GDP per person was 1st out of all 50 states. The Bureau of Economic Analysis (BEA) provides detailed GDP tables that break down the U.S. gross domestic product by geography, industry, and other variables. The Bureau of Economic Analysis (BEA) provides detailed GDP tables that break down the U.S. gross domestic product by geography, industry, and other variables. The Bureau of Economic Analysis (BEA) provides detailed GDP tables that break down the U.S. gross domestic product by geography, industry, and other variables. This dot plot displays the real gross domestic product (GDP) by industry in New York for the years 2013 and 2023, using chained 2017 dollars.", "score": 0.97888, "raw_content": null}], "response_time": 1.55}', name='tavily_search', id='a85e4175-228d-45c7-bd41-67edf259d26d', tool_call_id='call_1_95e6b08c-b10b-48d2-9f55-f133b1960622'), AIMessage(content="1. **US GDP in 2024**: The U.S. Bureau of Economic Analysis (BEA) reported that the real GDP increased at an annual rate of 2.4% in the fourth quarter of 2024. However, the exact nominal GDP figure for 2024 is not directly provided in the sources.  \n   - Source: [BEA](https://www.bea.gov/news/2025/gross-domestic-product-4th-quarter-and-year-2024-third-estimate-gdp-industry-and)  \n\n2. **New York State GDP in 2024**: The exact GDP figure for New York in 2024 is not explicitly mentioned in the sources. However, New York's economy is significant, ranking as the 8th largest in the world if it were an independent nation.  \n   - Source: [Statista](https://www.statista.com/statistics/188087/gdp-of-the-us-federal-state-of-new-york-since-1997/)  \n\n3. **Percentage of US GDP from New York**: The percentage is not directly available in the sources. Further research is needed to calculate this based on the GDP figures for both the US and New York in 2024.", additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 251, 'prompt_tokens': 3555, 'total_tokens': 3806, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 2752}, 'prompt_cache_hit_tokens': 2752, 'prompt_cache_miss_tokens': 803}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': '5b42a833-4f85-4845-959d-34d06a308317', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, name='research_agent', id='run--079fe39e-d927-4ec4-9b94-b2a3fcec6005-0', usage_metadata={'input_tokens': 3555, 'output_tokens': 251, 'total_tokens': 3806, 'input_token_details': {'cache_read': 2752}, 'output_token_details': {}}), AIMessage(content='Transferring back to supervisor', additional_kwargs={}, response_metadata={'__is_handoff_back': True}, name='research_agent', id='29830fd8-cf31-471d-947e-08441b2fe78b', tool_calls=[{'name': 'transfer_back_to_supervisor', 'args': {}, 'id': '9a2ca9c3-5e67-40d0-b024-c0afac74c325', 'type': 'tool_call'}]), ToolMessage(content='Successfully transferred back to supervisor', name='transfer_back_to_supervisor', id='606ff6d1-c780-46de-91dd-c0b46b3783a0', tool_call_id='9a2ca9c3-5e67-40d0-b024-c0afac74c325'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_0_2924c560-fab0-41e7-a731-9135f8143679', 'function': {'arguments': '{}', 'name': 'transfer_to_math_agent'}, 'type': 'function', 'index': 0}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 18, 'prompt_tokens': 2027, 'total_tokens': 2045, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 192}, 'prompt_cache_hit_tokens': 192, 'prompt_cache_miss_tokens': 1835}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': '535e9349-041e-4fd1-acd6-2e319ef3f244', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, name='supervisor', id='run--9016ed2e-b68d-4cf5-a63f-aa5710d03c6e-0', tool_calls=[{'name': 'transfer_to_math_agent', 'args': {}, 'id': 'call_0_2924c560-fab0-41e7-a731-9135f8143679', 'type': 'tool_call'}], usage_metadata={'input_tokens': 2027, 'output_tokens': 18, 'total_tokens': 2045, 'input_token_details': {'cache_read': 192}, 'output_token_details': {}}), ToolMessage(content='Successfully transferred to math_agent', name='transfer_to_math_agent', id='62a11cd1-45b6-4935-8a5a-ae821fb66f0c', tool_call_id='call_0_2924c560-fab0-41e7-a731-9135f8143679'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_0_729fbe94-b15f-4e84-b48e-e05049c9b050', 'function': {'arguments': '{"query": "US nominal GDP 2024 in billion USD"}', 'name': 'tavily_search'}, 'type': 'function', 'index': 0}, {'id': 'call_1_5aa79fc9-26ca-4ed1-b5bb-684942b9f5ef', 'function': {'arguments': '{"query": "New York state nominal GDP 2024 in billion USD"}', 'name': 'tavily_search'}, 'type': 'function', 'index': 1}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 59, 'prompt_tokens': 2201, 'total_tokens': 2260, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 320}, 'prompt_cache_hit_tokens': 320, 'prompt_cache_miss_tokens': 1881}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': '15475d5c-e1b4-4718-bac9-1a54cedb3d48', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, name='math_agent', id='run--9558cc1e-6f08-48d3-bc5b-03540669b57d-0', tool_calls=[{'name': 'tavily_search', 'args': {'query': 'US nominal GDP 2024 in billion USD'}, 'id': 'call_0_729fbe94-b15f-4e84-b48e-e05049c9b050', 'type': 'tool_call'}, {'name': 'tavily_search', 'args': {'query': 'New York state nominal GDP 2024 in billion USD'}, 'id': 'call_1_5aa79fc9-26ca-4ed1-b5bb-684942b9f5ef', 'type': 'tool_call'}], usage_metadata={'input_tokens': 2201, 'output_tokens': 59, 'total_tokens': 2260, 'input_token_details': {'cache_read': 320}, 'output_token_details': {}}), ToolMessage(content='Error: tavily_search is not a valid tool, try one of [add, multiply, divide].', name='tavily_search', id='32521cad-19c0-4228-8e4b-3cc8aab69410', tool_call_id='call_0_729fbe94-b15f-4e84-b48e-e05049c9b050', status='error'), ToolMessage(content='Error: tavily_search is not a valid tool, try one of [add, multiply, divide].', name='tavily_search', id='9f5b7b4f-ecf9-4334-9f64-b8e82e4736d5', tool_call_id='call_1_5aa79fc9-26ca-4ed1-b5bb-684942b9f5ef', status='error'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_0_67067b46-5dc4-4c85-9bfb-5e06e01747ed', 'function': {'arguments': '{}', 'name': 'transfer_to_research_agent'}, 'type': 'function', 'index': 0}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 18, 'prompt_tokens': 2310, 'total_tokens': 2328, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 2240}, 'prompt_cache_hit_tokens': 2240, 'prompt_cache_miss_tokens': 70}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': 'a419e8e2-c95a-4c60-a78a-3a025cd69de2', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, name='math_agent', id='run--ae70e762-2808-4cde-85c2-1fefb230f014-0', tool_calls=[{'name': 'transfer_to_research_agent', 'args': {}, 'id': 'call_0_67067b46-5dc4-4c85-9bfb-5e06e01747ed', 'type': 'tool_call'}], usage_metadata={'input_tokens': 2310, 'output_tokens': 18, 'total_tokens': 2328, 'input_token_details': {'cache_read': 2240}, 'output_token_details': {}}), ToolMessage(content='Error: transfer_to_research_agent is not a valid tool, try one of [add, multiply, divide].', name='transfer_to_research_agent', id='0b944951-19b5-42f1-a0a8-d4b701dc8e67', tool_call_id='call_0_67067b46-5dc4-4c85-9bfb-5e06e01747ed', status='error'), AIMessage(content='', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 0, 'prompt_tokens': 2357, 'total_tokens': 2357, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 2304}, 'prompt_cache_hit_tokens': 2304, 'prompt_cache_miss_tokens': 53}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': '0e5a2adc-b1b6-460d-bc22-31d510c60084', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, name='math_agent', id='run--3374f36e-6fbb-46e2-93f7-6d6e71574257-0', usage_metadata={'input_tokens': 2357, 'output_tokens': 0, 'total_tokens': 2357, 'input_token_details': {'cache_read': 2304}, 'output_token_details': {}}), AIMessage(content='Transferring back to supervisor', additional_kwargs={}, response_metadata={'__is_handoff_back': True}, name='math_agent', id='f3136452-7348-456d-8caa-b5fd6cee9843', tool_calls=[{'name': 'transfer_back_to_supervisor', 'args': {}, 'id': 'b15e7e40-b556-44e0-9987-fb51d7b2583c', 'type': 'tool_call'}]), ToolMessage(content='Successfully transferred back to supervisor', name='transfer_back_to_supervisor', id='1e2769ff-f25a-4fbc-b693-bde79e01cac3', tool_call_id='b15e7e40-b556-44e0-9987-fb51d7b2583c'), AIMessage(content='It seems the math agent is unable to perform the required research tasks. Let me transfer this back to the research agent to gather the necessary GDP figures for 2024.', additional_kwargs={'tool_calls': [{'id': 'call_0_caa2cf2f-bfbf-4811-80a2-2600254718ae', 'function': {'arguments': '{}', 'name': 'transfer_to_research_agent'}, 'type': 'function', 'index': 0}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 52, 'prompt_tokens': 2230, 'total_tokens': 2282, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 1984}, 'prompt_cache_hit_tokens': 1984, 'prompt_cache_miss_tokens': 246}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': '2da1501e-b51d-4311-9787-66a948c78628', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, name='supervisor', id='run--d75d5944-a2eb-4007-aadc-7d1feaf92f82-0', tool_calls=[{'name': 'transfer_to_research_agent', 'args': {}, 'id': 'call_0_caa2cf2f-bfbf-4811-80a2-2600254718ae', 'type': 'tool_call'}], usage_metadata={'input_tokens': 2230, 'output_tokens': 52, 'total_tokens': 2282, 'input_token_details': {'cache_read': 1984}, 'output_token_details': {}}), ToolMessage(content='Successfully transferred to research_agent', name='transfer_to_research_agent', id='1a4e27f0-7baa-4093-83a0-8bbaf9258e94', tool_call_id='call_0_caa2cf2f-bfbf-4811-80a2-2600254718ae'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_0_76d39e69-03c1-4f37-b89c-843d7678738b', 'function': {'arguments': '{"query": "US nominal GDP 2024 in billion USD"}', 'name': 'tavily_search'}, 'type': 'function', 'index': 0}, {'id': 'call_1_052ee5b3-f8b0-4e75-94ef-bac147e438f7', 'function': {'arguments': '{"query": "New York state nominal GDP 2024 in billion USD"}', 'name': 'tavily_search'}, 'type': 'function', 'index': 1}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 59, 'prompt_tokens': 4089, 'total_tokens': 4148, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 3776}, 'prompt_cache_hit_tokens': 3776, 'prompt_cache_miss_tokens': 313}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': '4d22fb46-3a5e-48ab-9edf-841364e66fcd', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, name='research_agent', id='run--8a1ced31-5085-49e6-ac7b-cdf9412bfc5b-0', tool_calls=[{'name': 'tavily_search', 'args': {'query': 'US nominal GDP 2024 in billion USD'}, 'id': 'call_0_76d39e69-03c1-4f37-b89c-843d7678738b', 'type': 'tool_call'}, {'name': 'tavily_search', 'args': {'query': 'New York state nominal GDP 2024 in billion USD'}, 'id': 'call_1_052ee5b3-f8b0-4e75-94ef-bac147e438f7', 'type': 'tool_call'}], usage_metadata={'input_tokens': 4089, 'output_tokens': 59, 'total_tokens': 4148, 'input_token_details': {'cache_read': 3776}, 'output_token_details': {}}), ToolMessage(content='{"query": "US nominal GDP 2024 in billion USD", "follow_up_questions": null, "answer": null, "images": [], "results": [{"url": "https://tradingeconomics.com/united-states/gdp", "title": "United States GDP - Trading Economics", "content": "The Gross Domestic Product (GDP) in the United States was worth 27720.71 billion US dollars in 2023, according to official data from the World Bank. This page provides - United States GDP - actual values, historical data, forecast, chart, statistics, economic calendar and news. | GDP Growth Rate | -0.20 | 2.40 | percent | Mar 2025 | GDP GDP GDP Annual Growth Rate GDP Growth Rate Core Inflation Rate MoM Core PCE Price Index MoM Core PCE Price Index YoY Export Prices MoM GDP Price Index Inflation Rate MoM PCE Price Index MoM House Price Index MoM House Price Index YoY Economic Calendar Historical Data News Stream Earnings Releases Credit Ratings Forecasts Markets Currencies Stocks Commodities Bonds Crypto Get Started", "score": 0.98587, "raw_content": null}, {"url": "https://www.economy.com/united-states/nominal-gross-domestic-product", "title": "United States Nominal Gross Domestic Product | Moody\'s Analytics", "content": "United States: GDP ; Nominal Gross Domestic Product, 2025 Q2, 30,331,117 ; Private Consumption, 2025 Q2, 20,640,878 ; Real Fixed Investment (gross fixed capital", "score": 0.98439, "raw_content": null}, {"url": "https://en.wikipedia.org/wiki/Economy_of_the_United_States", "title": "Economy of the United States - Wikipedia", "content": "Economy of the United States - Wikipedia | Image 489Companies of the United States | | Government institutions | * Department of the Treasury * Department of Commerce * Department of Labor * Office of the United States Trade Representative * Small Business Administration * Internal Revenue Service * National Labor Relations Board * United States Trade and Development Agency * Customs and Border Protection * Office of the Comptroller of the Currency * Consumer Financial Protection Bureau * Securities and Exchange Commission * Federal Deposit Insurance Corporation * National Credit Union Administration * United States International Trade Commission * Statistics | | International development | * U.S. International Development Finance Corporation * Blue Dot Network * Partnership for Global Infrastructure and Investment * Export–Import Bank of the United States |", "score": 0.97855, "raw_content": null}], "response_time": 0.92}', name='tavily_search', id='8c84a296-b587-4a88-89fb-4bd95de6d5e1', tool_call_id='call_0_76d39e69-03c1-4f37-b89c-843d7678738b'), ToolMessage(content='{"query": "New York state nominal GDP 2024 in billion USD", "follow_up_questions": null, "answer": null, "images": [], "results": [{"url": "https://www.statista.com/statistics/304883/new-york-real-gdp-by-industry/", "title": "U.S. real value added to GDP in New York 2023, by industry", "content": "Success stories Live webinars & recordings Prices & Access Business Solutions Academia and Government My Account Prices & Access Business Solutions Academia and Government Statistics Popular Statistics Topics Markets Reports Market Insights Consumer Insights eCommerce Insights Research AI Daily Data Services About Statista Statista+ Statista Q ask Statista nxt Statista Content & Design Statista R Solutions Why Statista Industry Agencies Consulting Goods Finance Tech Function Marketing Research & Development Strategy Use case Tell the story Find the fact Win the pitch Understand the market Develop your strategy DE ES FR Economy & Politics› Economy U.S. real value added to GDP in New York 2023, by industry Published by Abigail Tierney, Oct 14, 2024 In 2023, the mining, quarrying, and oil and gas extraction industry added about 730 million chained 2017 U.S. dollars of value to New York\'s GDP. Total real GDP amounted to about 1.79 trillion chained 2017 U.S. dollars. Read more Real value added to the gross domestic product of New York in the United States in 2023, by industry (in billion chained 2017 U.S. dollars) table column chart Search: Records: | Industry | Real value added in billion chained (2017) U.S. dollars | | --- | --- | | Finance, insurance, real estate, rental, and leasing | 576.89 | | Professional and business services | 260.12 | | Information | 196.57 | | Government and government enterprises | 175.64 | | Educational services, health care, and social assistance | 173.21 | | Retail trade | 77.7 | | Arts, entertainment, recreation, accommodation, and food services | 73.12 | | Manufacturing | 69.69 | | Wholesale trade | 63.48 | | Construction | 43.18 | | Transportation and warehousing | 39.68 | | Utilities | 22.4 | | Agriculture, forestry, fishing, and hunting | 2.8 | Showing entries 1 to 13 (14 entries in total) Previous Next 0100200300400500600700 Expand statistic Additional Information © Statista 2025 Show source Add this content to your personal favorites.", "score": 0.6415577, "raw_content": null}, {"url": "https://en.wikipedia.org/wiki/Economy_of_New_York_(state)", "title": "Economy of New York (state)", "content": "Economy of New York (state) - Wikipedia Economy of New York (state) If New York State were an independent nation, it would rank as the 8th largest economy in the world by nominal GDP. Wind is the predominant generating technology.[26] In 2018, the New York State Energy Research and Development Authority awarded long-term contracts to 22 utility-scale solar farms, totaling a combined capacity of 646 MW.[27]In 2012, LIPA adopted a power purchase agreement (limited to 50 MW), which will pay $0.22/kWh for solar generation for installations ranging from 50\xa0kW to 20 MW. State of New York Retrieved from \\"https://en.wikipedia.org/w/index.php?title=Economy_of_New_York_(state)&oldid=1284867348\\" Economy of New York (state) Economy of New York (state)", "score": 0.30551133, "raw_content": null}, {"url": "https://www.statista.com/statistics/248023/us-gross-domestic-product-gdp-by-state/", "title": "U.S. gross domestic product 2024, by state", "content": "Basic Statistic U.S. real value added to GDP in Indiana 2023, by industry Basic Statistic U.S. real value added to GDP in Minnesota 2022, by industry Basic Statistic U.S. real value added to GDP in Arizona 2023, by industry Basic Statistic U.S. real value added to GDP in Kansas 2023, by industry Basic Statistic U.S. real value added to GDP in New Hampshire 2023, by industry Basic Statistic U.S. real value added to GDP in Utah 2023, by industry Basic Statistic U.S. real value added to GDP in Michigan 2023, by industry Basic Statistic U.S. real value added to GDP in Arkansas 2023, by industry Basic Statistic U.S. real value added to GDP in New Mexico 2023, by industry", "score": 0.22015837, "raw_content": null}], "response_time": 1.41}', name='tavily_search', id='94b4a1e4-278d-43e7-89e7-adf0e117c90d', tool_call_id='call_1_052ee5b3-f8b0-4e75-94ef-bac147e438f7'), AIMessage(content="1. **US Nominal GDP in 2024**: The exact nominal GDP figure for the US in 2024 is not directly provided in the sources. However, the GDP in 2023 was approximately $27,720.71 billion USD, and forecasts suggest continued growth.  \n   - Source: [Trading Economics](https://tradingeconomics.com/united-states/gdp)  \n\n2. **New York State Nominal GDP in 2024**: The exact nominal GDP figure for New York in 2024 is not explicitly mentioned in the sources. However, in 2023, New York's real GDP was approximately $1.79 trillion (in chained 2017 dollars).  \n   - Source: [Statista](https://www.statista.com/statistics/304883/new-york-real-gdp-by-industry/)  \n\n3. **Percentage of US GDP from New York**: The percentage cannot be calculated without the exact nominal GDP figures for both the US and New York in 2024. Further research is needed to obtain these specific values.", additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 219, 'prompt_tokens': 5758, 'total_tokens': 5977, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 4096}, 'prompt_cache_hit_tokens': 4096, 'prompt_cache_miss_tokens': 1662}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': 'bd3ab11e-1d7f-4a96-b234-c1a4add766e3', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, name='research_agent', id='run--d3f2ed21-c700-4d65-84e8-1ebf02b92788-0', usage_metadata={'input_tokens': 5758, 'output_tokens': 219, 'total_tokens': 5977, 'input_token_details': {'cache_read': 4096}, 'output_token_details': {}}), AIMessage(content='Transferring back to supervisor', additional_kwargs={}, response_metadata={'__is_handoff_back': True}, name='research_agent', id='7bdcd3fc-ea41-46bd-a4c0-446478c57600', tool_calls=[{'name': 'transfer_back_to_supervisor', 'args': {}, 'id': '9f2b903a-a8f8-456d-af77-cc2948c47ee4', 'type': 'tool_call'}]), ToolMessage(content='Successfully transferred back to supervisor', name='transfer_back_to_supervisor', id='67518605-b8a6-42f7-9169-a4f2fa4f1135', tool_call_id='9f2b903a-a8f8-456d-af77-cc2948c47ee4'), AIMessage(content="It appears that the exact nominal GDP figures for the US and New York in 2024 are not readily available in the sources provided. Would you like me to refine the search or explore alternative sources to find these specific values? Alternatively, we could proceed with estimates based on historical data if that would be helpful. Let me know how you'd like to proceed!", additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 72, 'prompt_tokens': 4198, 'total_tokens': 4270, 'completion_tokens_details': None, 'prompt_tokens_details': {'audio_tokens': None, 'cached_tokens': 2240}, 'prompt_cache_hit_tokens': 2240, 'prompt_cache_miss_tokens': 1958}, 'model_name': 'deepseek-chat', 'system_fingerprint': 'fp_8802369eaa_prod0623_fp8_kvcache', 'id': '1b9e6bb4-e2fc-481a-a8be-5194995e96d9', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, name='supervisor', id='run--77bb4a99-5f03-4b60-9300-4b037321e619-0', usage_metadata={'input_tokens': 4198, 'output_tokens': 72, 'total_tokens': 4270, 'input_token_details': {'cache_read': 2240}, 'output_token_details': {}})]
#